<div class="dialog">
  <div class="dialog__header">
    <h2>{{ data?.property?.id ? 'Actualizar Lote' : 'Crear Lote' }}</h2>
    <lucide-icon
      [img]="X"
      class="close cursor-pointer"
      (click)="closeDialog()">
    </lucide-icon>
  </div>

  <div class="dialog__body">
    <div class="container grid grid-cols-1 md:grid-cols-2 gap-4" [formGroup]="form">
      <!-- Código del Lote -->
      <app-input
        label="Código del Lote"
        [form_control]="form.controls['code']">
      </app-input>

      <!-- Manzana -->
      <app-input
        label="Manzana"
        [form_control]="form.controls['block']">
      </app-input>

      <!-- Nombre -->
      <div class="md:col-span-2">
        <app-input
          label="Nombre del Lote"
          [form_control]="form.controls['name']">
        </app-input>
      </div>

      <!-- Descripción -->
      <div class="md:col-span-2">
        <app-input
          label="Descripción"
          type="textarea"
          [form_control]="form.controls['description']">
        </app-input>
      </div>

      <!-- Ubicación -->
      <div class="md:col-span-2">
        <app-input
          label="Ubicación"
          [form_control]="form.controls['location']">
        </app-input>
      </div>

      <!-- Proyecto/Grupo -->
      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700 mb-1">Proyecto</label>
        <app-select
          [config]="groupSelectConfig">
        </app-select>
      </div>

      <!-- Área Total -->
      <app-input
        label="Área Total"
        type="number"
        [form_control]="form.controls['total_area']">
      </app-input>

      <!-- Unidad de Medida -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Unidad de Medida</label>
        <app-select
          [config]="measurementUnitSelectConfig">
        </app-select>
      </div>

      <!-- Precio Total -->
      <app-input
        label="Precio Total"
        type="number"
        [form_control]="form.controls['total_price']">
      </app-input>

      <!-- Moneda -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Moneda</label>
        <app-select
          [config]="currencySelectConfig">
        </app-select>
      </div>

      <!-- Estado -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Estado</label>
        <app-select
          [config]="statusSelectConfig">
        </app-select>
      </div>

      <!-- Propietario (solo lectura) -->
      <div *ngIf="data?.property?.id && getOwnerName()">
        <label class="block text-sm font-medium text-gray-700 mb-1">Propietario</label>
        <div class="flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg">
          <span 
            (click)="navigateToCustomer()"
            class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 cursor-pointer hover:bg-blue-200 transition-colors">
            {{ getOwnerName() }}
          </span>
          <span class="text-xs text-gray-500">(Contrato activo)</span>
        </div>
      </div>
    </div>
  </div>

  <div class="dialog__footer">
    <app-button
      [text]="data?.property?.id ? 'Actualizar' : 'Crear'"
      custom_class="btn_primary"
      [loading]="loading()"
      (clicked)="submit()">
    </app-button>
  </div>
</div>
